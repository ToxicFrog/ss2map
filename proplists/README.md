# Proplists and Proptypes

Dark Engine object properties are stored in named chunks, one per property, which
contains all the property values for each object that has that property. Unfortunately,
the property name is the *only* metadata available in the tagfile; information about
what fields each property has, and how it's stored on disk, is the purview of the
game engine. This directory contains information about how to read and display these
properties.

## Proplist files

These are the files named `<game>.proplist`, e.g. `ss2.proplist` for System Shock 2.
They contain information about which properties the engine understands, what they are
called, and what fields and data types they have. They are generated by the Dark Engine
and included here for convenience.

The ones that come with ss2map are as follows:

- `ss2.proplist`: System Shock 2 v2.48
- `t1.proplist`: Thief Gold v1.26
- `t2.proplist`: Thief 2 v1.25

### Generating your own proplist

To generate one yourself, start up the game, open the console with `:`, and run the
`dump_props_full` command; a `proplist.txt` will appear in the game directory. To
use it in these tools, put it in this directory and rename it `<game>.proplist`, then
load it with `--propformat <game>`.

## Proptype files

A proptype file contains information about how to read and display the data for
specific property types. That is, while a proplist file associates property names
with property types, a proptype file associates property types with specific layouts
of bytes and code to display them to the user.

`common.lua` contains types that are common across all Dark Engine games -- not just
that they have the same name and type, but that the type is stored in the same way.

`<game>.lua` files contain type definitions specific to the given game. See `ss2.lua`
for an example. Note that the same type may appear in multiple game-specific files,
since it's not always stored in the same way across games -- for example, `sKeyInfo`
is used in both Thief and System Shock 2, but has a different storage format!

### Writing a new proptype file

In principle, these could be generated automatically someday by reading the XML files
that come with NewDark, but that's not implemented yet. In practice you just write
your own for the specific types you want; again, see `ss2.lua` for an example, and
`common.lua` for a broader survey of various types.

If you don't need any game-specific proptypes, a minimal file just contains the single line:

    return require 'proplists.common'
